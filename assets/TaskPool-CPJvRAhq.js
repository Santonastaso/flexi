import{u as m,a as u,b as f,r as p,j as t,R as v,c as N,d as b,e as j,f as _}from"./index-C4cgJIS8.js";const D=v.memo(({task:e})=>{const{isEditMode:n,conflictDialog:r,schedulingLoading:i}=m(),{updateOdpOrder:s}=u();N("TaskPool");const a=b(),{attributes:l,listeners:g,setNodeRef:h,transform:d}=j({id:`task-${e.id}`,data:{task:e,type:"task"},disabled:!n}),x=d?{transform:`translate3d(${d.x}px, ${d.y}px, 0)`}:void 0,c=i.taskId===e.id&&(i.isScheduling||i.isRescheduling||i.isShunting);return t.jsxs("div",{ref:h,style:x,className:`task-item ${n?"":"non-draggable"} ${r.isOpen&&r.details?.draggedTask?.id===e.id?"conflict-pending":""} ${c?"processing":""}`,children:[t.jsxs("div",{className:"task-content",children:[t.jsx("span",{className:"task-label",children:e.odp_number}),t.jsxs("span",{className:"task-time",children:[e.time_remaining?Number(e.time_remaining).toFixed(1):(e.duration||1).toFixed(1),"h"]}),c&&t.jsx("div",{className:"task-loading-indicator",children:t.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"})})]}),t.jsxs("div",{className:"task-controls",children:[t.jsx("button",{className:"task-btn info-btn",onClick:o=>{o.stopPropagation(),o.preventDefault()},onMouseDown:o=>{o.stopPropagation(),o.preventDefault()},onPointerDown:o=>{o.stopPropagation(),o.preventDefault()},title:`Codice Articolo: ${e.article_code||"Non specificato"}
Codice Articolo Esterno: ${e.external_article_code||"Non specificato"}
Nome Cliente: ${e.nome_cliente||"Non specificato"}
        Data Consegna: ${e.delivery_date?_(new Date(e.delivery_date),"yyyy-MM-dd"):"Non impostata"}
QuantitÃ : ${e.quantity||"Non specificata"}
Note Libere: ${e.user_notes||"Nessuna nota"}
        ${e.scheduled_start_time?`Inizio Programmato: ${e.scheduled_start_time.replace("+00:00","")}`:"Non programmato"}
        ${e.scheduled_end_time?`Fine Programmata: ${e.scheduled_end_time.replace("+00:00","")}`:"Non programmato"}`,children:t.jsx("span",{style:{fontSize:"12px",fontWeight:"bold",color:"#374151"},children:"i"})}),t.jsx("button",{className:"task-btn edit-btn",onClick:o=>{o.stopPropagation(),o.preventDefault(),a(`/backlog/${e.id}/edit`)},onMouseDown:o=>{o.stopPropagation(),o.preventDefault()},onPointerDown:o=>{o.stopPropagation(),o.preventDefault()},title:"Modifica e ricalcola",children:t.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),n&&t.jsx("div",{className:"drag-handle",...g,...l,title:"Trascina per programmare",children:t.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})})})]})]})});function P(){const{selectedWorkCenter:e}=m(),{odpOrders:n}=u(),{setNodeRef:r}=f({id:"task-pool",data:{type:"pool"}}),i=p.useMemo(()=>{let s=n.filter(a=>a.status!=="SCHEDULED");return e&&e!=="BOTH"&&(s=s.filter(a=>a.work_center===e)),s},[n,e]);return p.useMemo(()=>i.reduce((s,a)=>{const l=a.time_remaining?Number(a.time_remaining):a.duration||1;return s+l},0),[i]),t.jsxs("div",{className:"task-pool-section",children:[t.jsx("div",{className:"section-controls",children:t.jsx("h2",{className:"section-title",children:"Pool Lavori"})}),t.jsx("div",{ref:r,id:"task_pool",className:"task-pool-grid",children:i.length>0?i.map(s=>t.jsx(D,{task:s},s.id)):t.jsxs("div",{className:"empty-state",children:[t.jsx("h3",{children:"Nessun lavoro non programmato disponibile"}),t.jsx("p",{children:"Aggiungi lavori al backlog per visualizzarli qui."})]})})]})}export{P as default};
