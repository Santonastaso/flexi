import{u as p,a as j,r as m,j as e,R as N,b as y}from"./index-tN8AwbVV.js";const D=N.memo(({task:t})=>{const[s,d]=m.useState(!0),[a,o]=m.useState(!1),r=p(n=>n.updateOdpOrder),{attributes:g,listeners:b,setNodeRef:k,transform:i}=y({id:`task-${t.id}`,data:{task:t,type:"task"},disabled:s}),v=i?{transform:`translate3d(${i.x}px, ${i.y}px, 0)`}:void 0,f=n=>{n.stopPropagation(),d(!s)},u=async n=>{if(!t.scheduled_start_time){console.log("Task is not scheduled yet, cannot move");return}if(!a){o(!0);try{const l=new Date(t.scheduled_start_time),h=900*1e3;let c;n==="back"?c=new Date(l.getTime()-h):c=new Date(l.getTime()+h);const x={scheduled_start_time:c.toISOString()};await r(t.id,x),console.log(`Task moved ${n} by 15 minutes`)}catch(l){console.error("Failed to move task:",l)}finally{o(!1)}}};return e.jsxs("div",{ref:k,style:v,className:"task-item",children:[e.jsxs("div",{className:"task-content",children:[e.jsx("span",{children:t.odp_number}),e.jsxs("span",{className:"task-duration",children:[t.duration||1,"h"]})]}),e.jsxs("div",{className:"task-controls",children:[e.jsx("button",{className:"task-btn info-btn",title:`Delivery Date: ${t.delivery_date?new Date(t.delivery_date).toLocaleDateString():"Not set"}
Quantity: ${t.quantity||"Not specified"}
${t.scheduled_start_time?`Scheduled: ${new Date(t.scheduled_start_time).toLocaleString()}`:""}`,disabled:a,children:"ℹ️"}),e.jsx("button",{className:`task-btn lock-btn ${s?"locked":"unlocked"}`,onClick:f,title:s?"Unlock to enable dragging":"Lock to disable dragging",disabled:a,children:s?"🔒":"🔓"}),!s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:`task-btn move-btn move-left ${a?"moving":""}`,onClick:n=>{n.stopPropagation(),u("back")},title:"Move back 15 minutes",disabled:a,children:a?"⏳":"⬅️"}),e.jsx("button",{className:`task-btn move-btn move-right ${a?"moving":""}`,onClick:n=>{n.stopPropagation(),u("forward")},title:"Move forward 15 minutes",disabled:a,children:a?"⏳":"➡️"})]}),!s&&e.jsx("div",{className:"drag-handle",...b,...g,title:"Drag to schedule",children:"🖐️"})]})]})});function T({tasks:t}){const s=p(o=>o.selectedWorkCenter),{setNodeRef:d}=j({id:"task-pool",data:{type:"pool"}}),a=m.useMemo(()=>{let o=t.filter(r=>r.status!=="SCHEDULED");return s&&s!=="BOTH"&&(o=o.filter(r=>r.work_center===s)),o},[t,s]);return e.jsxs("div",{className:"task-pool-section",children:[e.jsx("h2",{children:"Task Pool"}),e.jsx("p",{children:"Drag tasks from here to schedule them, or drag scheduled events back here to unschedule them."}),e.jsx("div",{ref:d,id:"task_pool",className:"task-pool-grid",children:a.length>0?a.map(o=>e.jsx(D,{task:o},o.id)):e.jsx("div",{className:"empty-state",children:"No unscheduled tasks available"})})]})}export{T as default};
